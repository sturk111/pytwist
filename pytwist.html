<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pytwist module &mdash; pytwist  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> pytwist
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">pytwist module</a></li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pytwist</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>pytwist module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/pytwist.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-pytwist">
<span id="pytwist-module"></span><h1>pytwist module<a class="headerlink" href="#module-pytwist" title="Permalink to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="pytwist.Et">
<span class="sig-prename descclassname"><span class="pre">pytwist.</span></span><span class="sig-name descname"><span class="pre">Et</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytwist.Et" title="Permalink to this definition"></a></dt>
<dd><p>A matrix that simultaneously rotates and strains the vector on which it operates.</p>
<p>See Bi et al. Phys. Rev. B 100, 035448 (2019).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>float</em>) – Rotation angle in radians.</p></li>
<li><p><strong>theta_s</strong> (<em>float</em>) – Strain angle in radians.</p></li>
<li><p><strong>e</strong> (<em>float</em>) – Strain magnitude.</p></li>
<li><p><strong>delta</strong> (<em>float</em>) – Poisson ratio.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2x2 numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pytwist.R">
<span class="sig-prename descclassname"><span class="pre">pytwist.</span></span><span class="sig-name descname"><span class="pre">R</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytwist.R" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytwist.TBGModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytwist.</span></span><span class="sig-name descname"><span class="pre">TBGModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.246</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytwist.TBGModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<blockquote>
<div><p>This is the model class for twisted bilayer graphene.</p>
<p>See Bistritzer and MacDonald PNAS 108 (30) 12233-12237.</p>
<dl class="simple">
<dt>theta<span class="classifier">float</span></dt><dd><p>Twist angle between the top and bottom bilayer in degrees.</p>
</dd>
<dt>phi<span class="classifier">float</span></dt><dd><p>Heterostrain angle in degrees relative to the atomic lattice.</p>
</dd>
<dt>epsilon<span class="classifier">float</span></dt><dd><p>Heterostrain magnitude.  For example, a value of 0.01 corresponds to a 1%
difference in lattice constants between the top and bottom layers.</p>
</dd>
<dt>a<span class="classifier">float</span></dt><dd><p>Lattice constant of graphene in nanometers.</p>
</dd>
<dt>beta<span class="classifier">float</span></dt><dd><p>Two center hopping modulus.  See Phys. Rev. B 100, 035448 (2019).</p>
</dd>
<dt>delta<span class="classifier">float</span></dt><dd><p>Poisson ratio for graphene.</p>
</dd>
<dt>vf<span class="classifier">float</span></dt><dd><p>Fermi velocity renormalization constant.  Typical values are 1.2 - 1.3.</p>
</dd>
<dt>u, up<span class="classifier">float</span></dt><dd><p>Interlayer hopping amplitudes in electron-Volts for AA and AB sites respectively.
u != up captures the effect of finite out of plane corrugation of the moire lattice.</p>
</dd>
<dt>cut<span class="classifier">float</span></dt><dd><p>Momentum space cut off in units of the moire lattice vector.
Larger values will result in a larger Hamiltonian matrix.
Convergence is typically attained by cut = 4.</p>
</dd>
</dl>
<p>Examples</p>
</div></blockquote>
<blockquote>
<div><p>Construct a model object representing a twisted bilayer graphene device with a twist angle
of 1.11 degrees, a strain angle of 15 degrees, a strain magnitude of 0.5%.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tbg</span> <span class="o">=</span> <span class="n">TBGModel</span><span class="p">(</span><span class="mf">1.11</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pytwist.TBGModel.gen_ham">
<span class="sig-name descname"><span class="pre">gen_ham</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ky</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytwist.TBGModel.gen_ham" title="Permalink to this definition"></a></dt>
<dd><p>Generate hamiltonian for a given k-point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kx</strong> (<em>float</em>) – x and y coordinates of the momentum point for which the Hamiltonian is to be generated
in inverse nanometers.  Note that kx points along Gamma-Gamma of the moire Brillouin zone.</p></li>
<li><p><strong>ky</strong> (<em>float</em>) – x and y coordinates of the momentum point for which the Hamiltonian is to be generated
in inverse nanometers.  Note that kx points along Gamma-Gamma of the moire Brillouin zone.</p></li>
<li><p><strong>xi</strong> (<em>+/- 1</em>) – Valley index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ham</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy matrix, shape (2*Nq, 2*Nq), dtype = complex</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Generate Hamiltonian and solve for eigenstates at the K point of the moire Brillouin zone (kx=ky=0).
Eigenvalues and eigenvectors are stored in vals and vecs respectively.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tbg</span> <span class="o">=</span> <span class="n">TTGModel</span><span class="p">(</span><span class="mf">1.11</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ham</span> <span class="o">=</span>  <span class="n">tbg</span><span class="o">.</span><span class="n">gen_ham</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">ham</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytwist.TBGModel.solve_DOS">
<span class="sig-name descname"><span class="pre">solve_DOS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-0.1,</span> <span class="pre">-0.099,</span> <span class="pre">-0.098,</span> <span class="pre">-0.097,</span> <span class="pre">-0.096,</span> <span class="pre">-0.095,</span> <span class="pre">-0.094,</span> <span class="pre">-0.093,</span> <span class="pre">-0.092,</span> <span class="pre">-0.091,</span> <span class="pre">-0.09,</span> <span class="pre">-0.089,</span> <span class="pre">-0.088,</span> <span class="pre">-0.087,</span> <span class="pre">-0.086,</span> <span class="pre">-0.085,</span> <span class="pre">-0.084,</span> <span class="pre">-0.083,</span> <span class="pre">-0.082,</span> <span class="pre">-0.081,</span> <span class="pre">-0.08,</span> <span class="pre">-0.079,</span> <span class="pre">-0.078,</span> <span class="pre">-0.077,</span> <span class="pre">-0.076,</span> <span class="pre">-0.075,</span> <span class="pre">-0.074,</span> <span class="pre">-0.073,</span> <span class="pre">-0.072,</span> <span class="pre">-0.071,</span> <span class="pre">-0.07,</span> <span class="pre">-0.069,</span> <span class="pre">-0.068,</span> <span class="pre">-0.067,</span> <span class="pre">-0.066,</span> <span class="pre">-0.065,</span> <span class="pre">-0.064,</span> <span class="pre">-0.063,</span> <span class="pre">-0.062,</span> <span class="pre">-0.061,</span> <span class="pre">-0.06,</span> <span class="pre">-0.059,</span> <span class="pre">-0.058,</span> <span class="pre">-0.057,</span> <span class="pre">-0.056,</span> <span class="pre">-0.055,</span> <span class="pre">-0.054,</span> <span class="pre">-0.053,</span> <span class="pre">-0.052,</span> <span class="pre">-0.051,</span> <span class="pre">-0.05,</span> <span class="pre">-0.049,</span> <span class="pre">-0.048,</span> <span class="pre">-0.047,</span> <span class="pre">-0.046,</span> <span class="pre">-0.045,</span> <span class="pre">-0.044,</span> <span class="pre">-0.043,</span> <span class="pre">-0.042,</span> <span class="pre">-0.041,</span> <span class="pre">-0.04,</span> <span class="pre">-0.039,</span> <span class="pre">-0.038,</span> <span class="pre">-0.037,</span> <span class="pre">-0.036,</span> <span class="pre">-0.035,</span> <span class="pre">-0.034,</span> <span class="pre">-0.033,</span> <span class="pre">-0.032,</span> <span class="pre">-0.031,</span> <span class="pre">-0.03,</span> <span class="pre">-0.029,</span> <span class="pre">-0.028,</span> <span class="pre">-0.027,</span> <span class="pre">-0.026,</span> <span class="pre">-0.025,</span> <span class="pre">-0.024,</span> <span class="pre">-0.023,</span> <span class="pre">-0.022,</span> <span class="pre">-0.021,</span> <span class="pre">-0.02,</span> <span class="pre">-0.019,</span> <span class="pre">-0.018,</span> <span class="pre">-0.017,</span> <span class="pre">-0.016,</span> <span class="pre">-0.015,</span> <span class="pre">-0.014,</span> <span class="pre">-0.013,</span> <span class="pre">-0.012,</span> <span class="pre">-0.011,</span> <span class="pre">-0.01,</span> <span class="pre">-0.009,</span> <span class="pre">-0.008,</span> <span class="pre">-0.007,</span> <span class="pre">-0.006,</span> <span class="pre">-0.005,</span> <span class="pre">-0.004,</span> <span class="pre">-0.003,</span> <span class="pre">-0.002,</span> <span class="pre">-0.001,</span> <span class="pre">0.,</span> <span class="pre">0.001,</span> <span class="pre">0.002,</span> <span class="pre">0.003,</span> <span class="pre">0.004,</span> <span class="pre">0.005,</span> <span class="pre">0.006,</span> <span class="pre">0.007,</span> <span class="pre">0.008,</span> <span class="pre">0.009,</span> <span class="pre">0.01,</span> <span class="pre">0.011,</span> <span class="pre">0.012,</span> <span class="pre">0.013,</span> <span class="pre">0.014,</span> <span class="pre">0.015,</span> <span class="pre">0.016,</span> <span class="pre">0.017,</span> <span class="pre">0.018,</span> <span class="pre">0.019,</span> <span class="pre">0.02,</span> <span class="pre">0.021,</span> <span class="pre">0.022,</span> <span class="pre">0.023,</span> <span class="pre">0.024,</span> <span class="pre">0.025,</span> <span class="pre">0.026,</span> <span class="pre">0.027,</span> <span class="pre">0.028,</span> <span class="pre">0.029,</span> <span class="pre">0.03,</span> <span class="pre">0.031,</span> <span class="pre">0.032,</span> <span class="pre">0.033,</span> <span class="pre">0.034,</span> <span class="pre">0.035,</span> <span class="pre">0.036,</span> <span class="pre">0.037,</span> <span class="pre">0.038,</span> <span class="pre">0.039,</span> <span class="pre">0.04,</span> <span class="pre">0.041,</span> <span class="pre">0.042,</span> <span class="pre">0.043,</span> <span class="pre">0.044,</span> <span class="pre">0.045,</span> <span class="pre">0.046,</span> <span class="pre">0.047,</span> <span class="pre">0.048,</span> <span class="pre">0.049,</span> <span class="pre">0.05,</span> <span class="pre">0.051,</span> <span class="pre">0.052,</span> <span class="pre">0.053,</span> <span class="pre">0.054,</span> <span class="pre">0.055,</span> <span class="pre">0.056,</span> <span class="pre">0.057,</span> <span class="pre">0.058,</span> <span class="pre">0.059,</span> <span class="pre">0.06,</span> <span class="pre">0.061,</span> <span class="pre">0.062,</span> <span class="pre">0.063,</span> <span class="pre">0.064,</span> <span class="pre">0.065,</span> <span class="pre">0.066,</span> <span class="pre">0.067,</span> <span class="pre">0.068,</span> <span class="pre">0.069,</span> <span class="pre">0.07,</span> <span class="pre">0.071,</span> <span class="pre">0.072,</span> <span class="pre">0.073,</span> <span class="pre">0.074,</span> <span class="pre">0.075,</span> <span class="pre">0.076,</span> <span class="pre">0.077,</span> <span class="pre">0.078,</span> <span class="pre">0.079,</span> <span class="pre">0.08,</span> <span class="pre">0.081,</span> <span class="pre">0.082,</span> <span class="pre">0.083,</span> <span class="pre">0.084,</span> <span class="pre">0.085,</span> <span class="pre">0.086,</span> <span class="pre">0.087,</span> <span class="pre">0.088,</span> <span class="pre">0.089,</span> <span class="pre">0.09,</span> <span class="pre">0.091,</span> <span class="pre">0.092,</span> <span class="pre">0.093,</span> <span class="pre">0.094,</span> <span class="pre">0.095,</span> <span class="pre">0.096,</span> <span class="pre">0.097,</span> <span class="pre">0.098,</span> <span class="pre">0.099,</span> <span class="pre">0.1])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_it</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytwist.TBGModel.solve_DOS" title="Permalink to this definition"></a></dt>
<dd><p>Solves the Hamiltonian for a grid of k points within the first Brillouin zone and computes
the full density of states (i.e. momentum integrated number of solutions per unit energy).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nk</strong> (<em>int</em>) – The total number of points in the moire Brillouin zone is nk**2.  Larger nk corresponds to more
accurate and more computationally expensive calculations.</p></li>
<li><p><strong>energies</strong> (<em>numpy array of floats</em>) – A list of energies in electron-Volts at which to compute the density of states.</p></li>
<li><p><strong>xi</strong> (<em>+/-1</em>) – Valley index.</p></li>
<li><p><strong>plot_it</strong> (<em>boolean</em>) – If true a function call will display a plot of the density of states projected onto each layer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dos</strong> – Array containing the density of states at each input energy.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array, shape (len(energies),)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Generate and plot the density of states on the top layer for energies at 2 meV increments from
-100 to +100 meV.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tbg</span> <span class="o">=</span> <span class="n">TBGModel</span><span class="p">(</span><span class="mf">1.11</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.102</span><span class="p">,</span><span class="mf">0.002</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dos</span> <span class="o">=</span> <span class="n">tbg</span><span class="o">.</span><span class="n">solve_DOS</span><span class="p">(</span><span class="n">energies</span> <span class="o">=</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">dos</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytwist.TBGModel.solve_along_path">
<span class="sig-name descname"><span class="pre">solve_along_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_it</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_eigenvectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytwist.TBGModel.solve_along_path" title="Permalink to this definition"></a></dt>
<dd><p>Compute the band structure along a path within the moire Brillouin zone.
The path is predefined to be K -&gt; Gamma -&gt; M -&gt; K’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res</strong> (<em>float</em>) – The resolution of the cut, defined as the number of points to sample along the line Gamma -&gt; K</p></li>
<li><p><strong>plot_it</strong> (<em>boolean</em>) – If true a function call will display a plot of the resulting band structure.</p></li>
<li><p><strong>return_eigenvectors</strong> (<em>boolean</em>) – If true return eigenvectors along the k path.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>evals_m</strong> (<em>numpy array, shape (len(kpath), 2*Nq)</em>) – Eigenvalues along the k path for valley xi = -1. Axis 0 indexes points along the k path.
Axis 1 indexes bands.</p></li>
<li><p><strong>evals_p</strong> (<em>numpy array, shape (len(kpath), 2*Nq)</em>) – Eigenvalues along the k path for valley xi = +1. Axis 0 indexes points along the k path.
Axis 1 indexes bands.</p></li>
<li><p><strong>evecs_m</strong> (<em>numpy array, shape (len(kpath), 2*Nq, 2*Nq)</em>) – Eigenvectors along the k path for valley xi = -1.  Axis 0 indexes points along the k path.
Axis 1 indexes into the eigenvector.  Axis 2 indexes bands.  E.g. evecs_m[i,:,j] is the
eigenvector for k point i and band j.</p></li>
<li><p><strong>evecs_p</strong> (<em>numpy array, shape (len(kpath), 2*Nq, 2*Nq)</em>) – Eigenvectors along the k path for valley xi = +1.  Axis 0 indexes points along the k path.
Axis 1 indexes into the eigenvector.  Axis 2 indexes bands.  E.g. evecs_p[i,:,j] is the
eigenvector for k point i and band j.</p></li>
<li><p><strong>kpath</strong> (<em>list of shape (2,) numpy arrays</em>) – List of k points along the path.  Each point is represented as a two component array in the list.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Solve for the bands along the path K -&gt; Gamma -&gt; M -&gt; K’, returning eigenvectors.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tbg</span> <span class="o">=</span> <span class="n">TDBGModel</span><span class="p">(</span><span class="mf">1.11</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evals_m</span><span class="p">,</span> <span class="n">evals_p</span><span class="p">,</span> <span class="n">evecs_m</span><span class="p">,</span> <span class="n">evecs_p</span><span class="p">,</span> <span class="n">kpath</span> <span class="o">=</span> <span class="n">tbg</span><span class="o">.</span><span class="n">solve_along_path</span><span class="p">(</span><span class="n">return_eigenvectors</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The same thing without returning eigenvectors.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">evals_m</span><span class="p">,</span> <span class="n">evals_p</span><span class="p">,</span> <span class="n">kpath</span> <span class="o">=</span> <span class="n">tbg</span><span class="o">.</span><span class="n">solve_along_path</span><span class="p">()</span>
</pre></div>
</div>
<p>A higher resolution computation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">evals_m</span><span class="p">,</span> <span class="n">evals_p</span><span class="p">,</span> <span class="n">kpath</span> <span class="o">=</span> <span class="n">tbg</span><span class="o">.</span><span class="n">solve_along_path</span><span class="p">(</span><span class="n">res</span> <span class="o">=</span> <span class="mi">64</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytwist.TDBGModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytwist.</span></span><span class="sig-name descname"><span class="pre">TDBGModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.246</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0797</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0975</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytwist.TDBGModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<blockquote>
<div><p>This is the model class for twisted double bilayer graphene.</p>
<p>See C. Rubio-Verdu*, S. Turkel* et al. Nat. Phys. 18(2), 196-202 and
Koshino Phys. Rev. B 99, 235406 (2019).</p>
<dl class="simple">
<dt>theta<span class="classifier">float</span></dt><dd><p>Twist angle between the top and bottom bilayer in degrees.</p>
</dd>
<dt>phi<span class="classifier">float</span></dt><dd><p>Heterostrain angle in degrees relative to the atomic lattice.</p>
</dd>
<dt>epsilon<span class="classifier">float</span></dt><dd><p>Heterostrain magnitude.  For example, a value of 0.01 corresponds to a 1%
difference in lattice constants between the top and bottom layers.</p>
</dd>
<dt>D<span class="classifier">float</span></dt><dd><p>Potential difference between adjacent layers in Volts.
This captures the effect of an external displacement field.</p>
</dd>
<dt>a<span class="classifier">float</span></dt><dd><p>Lattice constant of graphene in nanometers.</p>
</dd>
<dt>beta<span class="classifier">float</span></dt><dd><p>Two center hopping modulus.  See Phys. Rev. B 100, 035448 (2019).</p>
</dd>
<dt>delta<span class="classifier">float</span></dt><dd><p>Poisson ratio for graphene.</p>
</dd>
<dt>vf<span class="classifier">float</span></dt><dd><p>Fermi velocity renormalization constant.  Typical values are 1.2 - 1.3.</p>
</dd>
<dt>u, up<span class="classifier">float</span></dt><dd><p>Interlayer hopping amplitudes in electron-Volts for AA and AB sites respectively.
u != up captures the effect of finite out of plane corrugation of the moire lattice.</p>
</dd>
<dt>cut<span class="classifier">float</span></dt><dd><p>Momentum space cut off in units of the moire lattice vector.
Larger values will result in a larger Hamiltonian matrix.
Convergence is typically attained by cut = 4.</p>
</dd>
</dl>
<p>Examples</p>
</div></blockquote>
<blockquote>
<div><p>Construct a model object representing a twisted double bilayer graphene device with a twist angle
of 1.05 degrees, a strain angle of 15 degrees, a strain magnitude of 0.5%, and zero displacement field.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tdbg</span> <span class="o">=</span> <span class="n">TDBGModel</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pytwist.TDBGModel.gen_ham">
<span class="sig-name descname"><span class="pre">gen_ham</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ky</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytwist.TDBGModel.gen_ham" title="Permalink to this definition"></a></dt>
<dd><p>Generate hamiltonian for a given k-point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kx</strong> (<em>float</em>) – x and y coordinates of the momentum point for which the Hamiltonian is to be generated
in inverse nanometers.  Note that kx points along Gamma-Gamma of the moire Brillouin zone.</p></li>
<li><p><strong>ky</strong> (<em>float</em>) – x and y coordinates of the momentum point for which the Hamiltonian is to be generated
in inverse nanometers.  Note that kx points along Gamma-Gamma of the moire Brillouin zone.</p></li>
<li><p><strong>xi</strong> (<em>+/- 1</em>) – Valley index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ham</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy matrix, shape (4*Nq, 4*Nq), dtype = complex</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Generate Hamiltonian and solve for eigenstates at the K point of the moire Brillouin zone (kx=ky=0).
Eigenvalues and eigenvectors are stored in vals and vecs respectively.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tdbg</span> <span class="o">=</span> <span class="n">TDBGModel</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ham</span> <span class="o">=</span>  <span class="n">tdbg</span><span class="o">.</span><span class="n">gen_ham</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">ham</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytwist.TDBGModel.solve_LDOS">
<span class="sig-name descname"><span class="pre">solve_LDOS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-0.1,</span> <span class="pre">-0.099,</span> <span class="pre">-0.098,</span> <span class="pre">-0.097,</span> <span class="pre">-0.096,</span> <span class="pre">-0.095,</span> <span class="pre">-0.094,</span> <span class="pre">-0.093,</span> <span class="pre">-0.092,</span> <span class="pre">-0.091,</span> <span class="pre">-0.09,</span> <span class="pre">-0.089,</span> <span class="pre">-0.088,</span> <span class="pre">-0.087,</span> <span class="pre">-0.086,</span> <span class="pre">-0.085,</span> <span class="pre">-0.084,</span> <span class="pre">-0.083,</span> <span class="pre">-0.082,</span> <span class="pre">-0.081,</span> <span class="pre">-0.08,</span> <span class="pre">-0.079,</span> <span class="pre">-0.078,</span> <span class="pre">-0.077,</span> <span class="pre">-0.076,</span> <span class="pre">-0.075,</span> <span class="pre">-0.074,</span> <span class="pre">-0.073,</span> <span class="pre">-0.072,</span> <span class="pre">-0.071,</span> <span class="pre">-0.07,</span> <span class="pre">-0.069,</span> <span class="pre">-0.068,</span> <span class="pre">-0.067,</span> <span class="pre">-0.066,</span> <span class="pre">-0.065,</span> <span class="pre">-0.064,</span> <span class="pre">-0.063,</span> <span class="pre">-0.062,</span> <span class="pre">-0.061,</span> <span class="pre">-0.06,</span> <span class="pre">-0.059,</span> <span class="pre">-0.058,</span> <span class="pre">-0.057,</span> <span class="pre">-0.056,</span> <span class="pre">-0.055,</span> <span class="pre">-0.054,</span> <span class="pre">-0.053,</span> <span class="pre">-0.052,</span> <span class="pre">-0.051,</span> <span class="pre">-0.05,</span> <span class="pre">-0.049,</span> <span class="pre">-0.048,</span> <span class="pre">-0.047,</span> <span class="pre">-0.046,</span> <span class="pre">-0.045,</span> <span class="pre">-0.044,</span> <span class="pre">-0.043,</span> <span class="pre">-0.042,</span> <span class="pre">-0.041,</span> <span class="pre">-0.04,</span> <span class="pre">-0.039,</span> <span class="pre">-0.038,</span> <span class="pre">-0.037,</span> <span class="pre">-0.036,</span> <span class="pre">-0.035,</span> <span class="pre">-0.034,</span> <span class="pre">-0.033,</span> <span class="pre">-0.032,</span> <span class="pre">-0.031,</span> <span class="pre">-0.03,</span> <span class="pre">-0.029,</span> <span class="pre">-0.028,</span> <span class="pre">-0.027,</span> <span class="pre">-0.026,</span> <span class="pre">-0.025,</span> <span class="pre">-0.024,</span> <span class="pre">-0.023,</span> <span class="pre">-0.022,</span> <span class="pre">-0.021,</span> <span class="pre">-0.02,</span> <span class="pre">-0.019,</span> <span class="pre">-0.018,</span> <span class="pre">-0.017,</span> <span class="pre">-0.016,</span> <span class="pre">-0.015,</span> <span class="pre">-0.014,</span> <span class="pre">-0.013,</span> <span class="pre">-0.012,</span> <span class="pre">-0.011,</span> <span class="pre">-0.01,</span> <span class="pre">-0.009,</span> <span class="pre">-0.008,</span> <span class="pre">-0.007,</span> <span class="pre">-0.006,</span> <span class="pre">-0.005,</span> <span class="pre">-0.004,</span> <span class="pre">-0.003,</span> <span class="pre">-0.002,</span> <span class="pre">-0.001,</span> <span class="pre">0.,</span> <span class="pre">0.001,</span> <span class="pre">0.002,</span> <span class="pre">0.003,</span> <span class="pre">0.004,</span> <span class="pre">0.005,</span> <span class="pre">0.006,</span> <span class="pre">0.007,</span> <span class="pre">0.008,</span> <span class="pre">0.009,</span> <span class="pre">0.01,</span> <span class="pre">0.011,</span> <span class="pre">0.012,</span> <span class="pre">0.013,</span> <span class="pre">0.014,</span> <span class="pre">0.015,</span> <span class="pre">0.016,</span> <span class="pre">0.017,</span> <span class="pre">0.018,</span> <span class="pre">0.019,</span> <span class="pre">0.02,</span> <span class="pre">0.021,</span> <span class="pre">0.022,</span> <span class="pre">0.023,</span> <span class="pre">0.024,</span> <span class="pre">0.025,</span> <span class="pre">0.026,</span> <span class="pre">0.027,</span> <span class="pre">0.028,</span> <span class="pre">0.029,</span> <span class="pre">0.03,</span> <span class="pre">0.031,</span> <span class="pre">0.032,</span> <span class="pre">0.033,</span> <span class="pre">0.034,</span> <span class="pre">0.035,</span> <span class="pre">0.036,</span> <span class="pre">0.037,</span> <span class="pre">0.038,</span> <span class="pre">0.039,</span> <span class="pre">0.04,</span> <span class="pre">0.041,</span> <span class="pre">0.042,</span> <span class="pre">0.043,</span> <span class="pre">0.044,</span> <span class="pre">0.045,</span> <span class="pre">0.046,</span> <span class="pre">0.047,</span> <span class="pre">0.048,</span> <span class="pre">0.049,</span> <span class="pre">0.05,</span> <span class="pre">0.051,</span> <span class="pre">0.052,</span> <span class="pre">0.053,</span> <span class="pre">0.054,</span> <span class="pre">0.055,</span> <span class="pre">0.056,</span> <span class="pre">0.057,</span> <span class="pre">0.058,</span> <span class="pre">0.059,</span> <span class="pre">0.06,</span> <span class="pre">0.061,</span> <span class="pre">0.062,</span> <span class="pre">0.063,</span> <span class="pre">0.064,</span> <span class="pre">0.065,</span> <span class="pre">0.066,</span> <span class="pre">0.067,</span> <span class="pre">0.068,</span> <span class="pre">0.069,</span> <span class="pre">0.07,</span> <span class="pre">0.071,</span> <span class="pre">0.072,</span> <span class="pre">0.073,</span> <span class="pre">0.074,</span> <span class="pre">0.075,</span> <span class="pre">0.076,</span> <span class="pre">0.077,</span> <span class="pre">0.078,</span> <span class="pre">0.079,</span> <span class="pre">0.08,</span> <span class="pre">0.081,</span> <span class="pre">0.082,</span> <span class="pre">0.083,</span> <span class="pre">0.084,</span> <span class="pre">0.085,</span> <span class="pre">0.086,</span> <span class="pre">0.087,</span> <span class="pre">0.088,</span> <span class="pre">0.089,</span> <span class="pre">0.09,</span> <span class="pre">0.091,</span> <span class="pre">0.092,</span> <span class="pre">0.093,</span> <span class="pre">0.094,</span> <span class="pre">0.095,</span> <span class="pre">0.096,</span> <span class="pre">0.097,</span> <span class="pre">0.098,</span> <span class="pre">0.099,</span> <span class="pre">0.1])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytwist.TDBGModel.solve_LDOS" title="Permalink to this definition"></a></dt>
<dd><p>Solves for the local density of states in real space.  The computation is performed for a momentum
space grid and then transformed to real space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nk</strong> (<em>int</em>) – The total number of points in the moire Brillouin zone is nk**2.  Larger nk corresponds to more
accurate and more computationally expensive calculations.</p></li>
<li><p><strong>px</strong> (<em>int</em>) – Number of pixels to include in the real space local density of states image.  The local
density of states is computed with a square aspect ratio and px is the number of pixels
along one side of the square.</p></li>
<li><p><strong>sz</strong> (<em>float</em>) – Size of the real space local density of states window.  Generated images are sz x sz nm^2</p></li>
<li><p><strong>l1</strong> (<em>float</em>) – Weight of top layer and second layer respectively.  Typically numbers between 0 and 1.
Projecting onto the top layer only corresponds to l1=1, l2=0.</p></li>
<li><p><strong>l2</strong> (<em>float</em>) – Weight of top layer and second layer respectively.  Typically numbers between 0 and 1.
Projecting onto the top layer only corresponds to l1=1, l2=0.</p></li>
<li><p><strong>energies</strong> (<em>numpy array of floats</em>) – A list of energies in electron-Volts at which to compute the local density of states.</p></li>
<li><p><strong>+/-1</strong> (<em>xi =</em>) – Valley index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>m</strong> – The local density of states in real space computed at each input energy.
m[:,:,i] is the local density of states over a sz x sz nm^2 window at energy energies[i].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array, shape (px, px, len(energies))</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Compute the Fermi level (energy = 0 eV) local density of states
over a 40 nm window with 256 pixel resolution.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tdbg</span> <span class="o">=</span> <span class="n">TDBGModel</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">tdbg</span><span class="o">.</span><span class="n">solve_LDOS</span><span class="p">(</span><span class="n">px</span> <span class="o">=</span> <span class="mi">256</span><span class="p">,</span> <span class="n">sz</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> <span class="n">energies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<p>Visualize the result.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">m</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytwist.TDBGModel.solve_PDOS">
<span class="sig-name descname"><span class="pre">solve_PDOS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-0.1,</span> <span class="pre">-0.099,</span> <span class="pre">-0.098,</span> <span class="pre">-0.097,</span> <span class="pre">-0.096,</span> <span class="pre">-0.095,</span> <span class="pre">-0.094,</span> <span class="pre">-0.093,</span> <span class="pre">-0.092,</span> <span class="pre">-0.091,</span> <span class="pre">-0.09,</span> <span class="pre">-0.089,</span> <span class="pre">-0.088,</span> <span class="pre">-0.087,</span> <span class="pre">-0.086,</span> <span class="pre">-0.085,</span> <span class="pre">-0.084,</span> <span class="pre">-0.083,</span> <span class="pre">-0.082,</span> <span class="pre">-0.081,</span> <span class="pre">-0.08,</span> <span class="pre">-0.079,</span> <span class="pre">-0.078,</span> <span class="pre">-0.077,</span> <span class="pre">-0.076,</span> <span class="pre">-0.075,</span> <span class="pre">-0.074,</span> <span class="pre">-0.073,</span> <span class="pre">-0.072,</span> <span class="pre">-0.071,</span> <span class="pre">-0.07,</span> <span class="pre">-0.069,</span> <span class="pre">-0.068,</span> <span class="pre">-0.067,</span> <span class="pre">-0.066,</span> <span class="pre">-0.065,</span> <span class="pre">-0.064,</span> <span class="pre">-0.063,</span> <span class="pre">-0.062,</span> <span class="pre">-0.061,</span> <span class="pre">-0.06,</span> <span class="pre">-0.059,</span> <span class="pre">-0.058,</span> <span class="pre">-0.057,</span> <span class="pre">-0.056,</span> <span class="pre">-0.055,</span> <span class="pre">-0.054,</span> <span class="pre">-0.053,</span> <span class="pre">-0.052,</span> <span class="pre">-0.051,</span> <span class="pre">-0.05,</span> <span class="pre">-0.049,</span> <span class="pre">-0.048,</span> <span class="pre">-0.047,</span> <span class="pre">-0.046,</span> <span class="pre">-0.045,</span> <span class="pre">-0.044,</span> <span class="pre">-0.043,</span> <span class="pre">-0.042,</span> <span class="pre">-0.041,</span> <span class="pre">-0.04,</span> <span class="pre">-0.039,</span> <span class="pre">-0.038,</span> <span class="pre">-0.037,</span> <span class="pre">-0.036,</span> <span class="pre">-0.035,</span> <span class="pre">-0.034,</span> <span class="pre">-0.033,</span> <span class="pre">-0.032,</span> <span class="pre">-0.031,</span> <span class="pre">-0.03,</span> <span class="pre">-0.029,</span> <span class="pre">-0.028,</span> <span class="pre">-0.027,</span> <span class="pre">-0.026,</span> <span class="pre">-0.025,</span> <span class="pre">-0.024,</span> <span class="pre">-0.023,</span> <span class="pre">-0.022,</span> <span class="pre">-0.021,</span> <span class="pre">-0.02,</span> <span class="pre">-0.019,</span> <span class="pre">-0.018,</span> <span class="pre">-0.017,</span> <span class="pre">-0.016,</span> <span class="pre">-0.015,</span> <span class="pre">-0.014,</span> <span class="pre">-0.013,</span> <span class="pre">-0.012,</span> <span class="pre">-0.011,</span> <span class="pre">-0.01,</span> <span class="pre">-0.009,</span> <span class="pre">-0.008,</span> <span class="pre">-0.007,</span> <span class="pre">-0.006,</span> <span class="pre">-0.005,</span> <span class="pre">-0.004,</span> <span class="pre">-0.003,</span> <span class="pre">-0.002,</span> <span class="pre">-0.001,</span> <span class="pre">0.,</span> <span class="pre">0.001,</span> <span class="pre">0.002,</span> <span class="pre">0.003,</span> <span class="pre">0.004,</span> <span class="pre">0.005,</span> <span class="pre">0.006,</span> <span class="pre">0.007,</span> <span class="pre">0.008,</span> <span class="pre">0.009,</span> <span class="pre">0.01,</span> <span class="pre">0.011,</span> <span class="pre">0.012,</span> <span class="pre">0.013,</span> <span class="pre">0.014,</span> <span class="pre">0.015,</span> <span class="pre">0.016,</span> <span class="pre">0.017,</span> <span class="pre">0.018,</span> <span class="pre">0.019,</span> <span class="pre">0.02,</span> <span class="pre">0.021,</span> <span class="pre">0.022,</span> <span class="pre">0.023,</span> <span class="pre">0.024,</span> <span class="pre">0.025,</span> <span class="pre">0.026,</span> <span class="pre">0.027,</span> <span class="pre">0.028,</span> <span class="pre">0.029,</span> <span class="pre">0.03,</span> <span class="pre">0.031,</span> <span class="pre">0.032,</span> <span class="pre">0.033,</span> <span class="pre">0.034,</span> <span class="pre">0.035,</span> <span class="pre">0.036,</span> <span class="pre">0.037,</span> <span class="pre">0.038,</span> <span class="pre">0.039,</span> <span class="pre">0.04,</span> <span class="pre">0.041,</span> <span class="pre">0.042,</span> <span class="pre">0.043,</span> <span class="pre">0.044,</span> <span class="pre">0.045,</span> <span class="pre">0.046,</span> <span class="pre">0.047,</span> <span class="pre">0.048,</span> <span class="pre">0.049,</span> <span class="pre">0.05,</span> <span class="pre">0.051,</span> <span class="pre">0.052,</span> <span class="pre">0.053,</span> <span class="pre">0.054,</span> <span class="pre">0.055,</span> <span class="pre">0.056,</span> <span class="pre">0.057,</span> <span class="pre">0.058,</span> <span class="pre">0.059,</span> <span class="pre">0.06,</span> <span class="pre">0.061,</span> <span class="pre">0.062,</span> <span class="pre">0.063,</span> <span class="pre">0.064,</span> <span class="pre">0.065,</span> <span class="pre">0.066,</span> <span class="pre">0.067,</span> <span class="pre">0.068,</span> <span class="pre">0.069,</span> <span class="pre">0.07,</span> <span class="pre">0.071,</span> <span class="pre">0.072,</span> <span class="pre">0.073,</span> <span class="pre">0.074,</span> <span class="pre">0.075,</span> <span class="pre">0.076,</span> <span class="pre">0.077,</span> <span class="pre">0.078,</span> <span class="pre">0.079,</span> <span class="pre">0.08,</span> <span class="pre">0.081,</span> <span class="pre">0.082,</span> <span class="pre">0.083,</span> <span class="pre">0.084,</span> <span class="pre">0.085,</span> <span class="pre">0.086,</span> <span class="pre">0.087,</span> <span class="pre">0.088,</span> <span class="pre">0.089,</span> <span class="pre">0.09,</span> <span class="pre">0.091,</span> <span class="pre">0.092,</span> <span class="pre">0.093,</span> <span class="pre">0.094,</span> <span class="pre">0.095,</span> <span class="pre">0.096,</span> <span class="pre">0.097,</span> <span class="pre">0.098,</span> <span class="pre">0.099,</span> <span class="pre">0.1])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_it</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytwist.TDBGModel.solve_PDOS" title="Permalink to this definition"></a></dt>
<dd><p>Solves the Hamiltonian for a grid of k points within the first Brillouin zone and computes
the density of states (i.e. momentum integrated number of solutions per unit energy)
projected onto each of the four layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nk</strong> (<em>int</em>) – The total number of points in the moire Brillouin zone is nk**2.  Larger nk corresponds to more
accurate and more computationally expensive calculations.</p></li>
<li><p><strong>energies</strong> (<em>numpy array of floats</em>) – A list of energies in electron-Volts at which to compute the density of states.</p></li>
<li><p><strong>xi</strong> (<em>+/-1</em>) – Valley index.</p></li>
<li><p><strong>plot_it</strong> (<em>boolean</em>) – If true a function call will display a plot of the density of states projected onto each layer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>PDOS</strong> – The list contains a numpy array containing the energy dependent density of states
for each of the four layers (elements 0-3) and the total density of states
across all layers (element 4).  PDOS[l][i] is the density of states
on layer l at energy energies[i].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of five numpy arrays, each of shape (len(energies),)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Generate and plot the density of states on the top layer for energies at 2 meV increments from
-100 to +100 meV.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tdbg</span> <span class="o">=</span> <span class="n">TDBGModel</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.102</span><span class="p">,</span><span class="mf">0.002</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PDOS</span> <span class="o">=</span> <span class="n">tdbg</span><span class="o">.</span><span class="n">solve_PDOS</span><span class="p">(</span><span class="n">energies</span> <span class="o">=</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">PDOS</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Plot the density of states on the second layer from the top.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">PDOS</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>Plot the full density of states.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">PDOS</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytwist.TDBGModel.solve_along_path">
<span class="sig-name descname"><span class="pre">solve_along_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_it</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_eigenvectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytwist.TDBGModel.solve_along_path" title="Permalink to this definition"></a></dt>
<dd><p>Compute the band structure along a path within the moire Brillouin zone.
The path is predefined to be K -&gt; Gamma -&gt; M -&gt; K’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res</strong> (<em>float</em>) – The resolution of the cut, defined as the number of points to sample along the line Gamma -&gt; K</p></li>
<li><p><strong>plot_it</strong> (<em>boolean</em>) – If true a function call will display a plot of the resulting band structure.</p></li>
<li><p><strong>return_eigenvectors</strong> (<em>boolean</em>) – If true return eigenvectors along the k path.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>evals_m</strong> (<em>numpy array, shape (len(kpath), 4*Nq)</em>) – Eigenvalues along the k path for valley xi = -1. Axis 0 indexes points along the k path.
Axis 1 indexes bands.</p></li>
<li><p><strong>evals_p</strong> (<em>numpy array, shape (len(kpath), 4*Nq)</em>) – Eigenvalues along the k path for valley xi = +1. Axis 0 indexes points along the k path.
Axis 1 indexes bands.</p></li>
<li><p><strong>evecs_m</strong> (<em>numpy array, shape (len(kpath), 4*Nq, 4*Nq)</em>) – Eigenvectors along the k path for valley xi = -1.  Axis 0 indexes points along the k path.
Axis 1 indexes into the eigenvector.  Axis 2 indexes bands.  E.g. evecs_m[i,:,j] is the
eigenvector for k point i and band j.</p></li>
<li><p><strong>evecs_p</strong> (<em>numpy array, shape (len(kpath), 4*Nq, 4*Nq)</em>) – Eigenvectors along the k path for valley xi = +1.  Axis 0 indexes points along the k path.
Axis 1 indexes into the eigenvector.  Axis 2 indexes bands.  E.g. evecs_p[i,:,j] is the
eigenvector for k point i and band j.</p></li>
<li><p><strong>kpath</strong> (<em>list of shape (2,) numpy arrays</em>) – List of k points along the path.  Each point is represented as a two component array in the list.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Solve for the bands along the path K -&gt; Gamma -&gt; M -&gt; K’, returning eigenvectors.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tdbg</span> <span class="o">=</span> <span class="n">TDBGModel</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evals_m</span><span class="p">,</span> <span class="n">evals_p</span><span class="p">,</span> <span class="n">evecs_m</span><span class="p">,</span> <span class="n">evecs_p</span><span class="p">,</span> <span class="n">kpath</span> <span class="o">=</span> <span class="n">tdbg</span><span class="o">.</span><span class="n">solve_along_path</span><span class="p">(</span><span class="n">return_eigenvectors</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The same thing without returning eigenvectors.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">evals_m</span><span class="p">,</span> <span class="n">evals_p</span><span class="p">,</span> <span class="n">kpath</span> <span class="o">=</span> <span class="n">tdbg</span><span class="o">.</span><span class="n">solve_along_path</span><span class="p">()</span>
</pre></div>
</div>
<p>A higher resolution computation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">evals_m</span><span class="p">,</span> <span class="n">evals_p</span><span class="p">,</span> <span class="n">kpath</span> <span class="o">=</span> <span class="n">tdbg</span><span class="o">.</span><span class="n">solve_along_path</span><span class="p">(</span><span class="n">res</span> <span class="o">=</span> <span class="mi">64</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytwist.TTGModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytwist.</span></span><span class="sig-name descname"><span class="pre">TTGModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.246</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.087</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.105</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytwist.TTGModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<blockquote>
<div><p>This is the model class for mirror symmetric twisted trilayer graphene in AtA configuration.</p>
<p>See S. Turkel et al. Science 376 (6589), 193-199.</p>
<dl class="simple">
<dt>theta<span class="classifier">float</span></dt><dd><p>Twist angle between the top and bottom bilayer in degrees.</p>
</dd>
<dt>phi<span class="classifier">float</span></dt><dd><p>Heterostrain angle in degrees relative to the atomic lattice.</p>
</dd>
<dt>epsilon<span class="classifier">float</span></dt><dd><p>Heterostrain magnitude.  For example, a value of 0.01 corresponds to a 1%
difference in lattice constants between the top and bottom layers.</p>
</dd>
<dt>D<span class="classifier">float</span></dt><dd><p>Potential difference between top and bottom layers in Volts.
This captures the effect of an external displacement field.</p>
</dd>
<dt>a<span class="classifier">float</span></dt><dd><p>Lattice constant of graphene in nanometers.</p>
</dd>
<dt>beta<span class="classifier">float</span></dt><dd><p>Two center hopping modulus.  See Phys. Rev. B 100, 035448 (2019).</p>
</dd>
<dt>delta<span class="classifier">float</span></dt><dd><p>Poisson ratio for graphene.</p>
</dd>
<dt>vf<span class="classifier">float</span></dt><dd><p>Fermi velocity renormalization constant.  Typical values are 1.2 - 1.3.</p>
</dd>
<dt>u, up<span class="classifier">float</span></dt><dd><p>Interlayer hopping amplitudes in electron-Volts for AA and AB sites respectively.
u != up captures the effect of finite out of plane corrugation of the moire lattice.</p>
</dd>
<dt>cut<span class="classifier">float</span></dt><dd><p>Momentum space cut off in units of the moire lattice vector.
Larger values will result in a larger Hamiltonian matrix.
Convergence is typically attained by cut = 4.</p>
</dd>
</dl>
<p>Examples</p>
</div></blockquote>
<blockquote>
<div><p>Construct a model object representing a twisted trilayer graphene device with a twist angle
of 1.56 degrees, a strain angle of 15 degrees, a strain magnitude of 0.5%, and zero displacement field.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ttg</span> <span class="o">=</span> <span class="n">TTGModel</span><span class="p">(</span><span class="mf">1.56</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="pytwist.TTGModel.gen_ham">
<span class="sig-name descname"><span class="pre">gen_ham</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ky</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytwist.TTGModel.gen_ham" title="Permalink to this definition"></a></dt>
<dd><p>Generate hamiltonian for a given k-point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kx</strong> (<em>float</em>) – x and y coordinates of the momentum point for which the Hamiltonian is to be generated
in inverse nanometers.  Note that kx points along Gamma-Gamma of the moire Brillouin zone.</p></li>
<li><p><strong>ky</strong> (<em>float</em>) – x and y coordinates of the momentum point for which the Hamiltonian is to be generated
in inverse nanometers.  Note that kx points along Gamma-Gamma of the moire Brillouin zone.</p></li>
<li><p><strong>xi</strong> (<em>+/- 1</em>) – Valley index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ham</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy matrix, shape (2*Nq, 2*Nq), dtype = complex</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Generate Hamiltonian and solve for eigenstates at the K point of the moire Brillouin zone (kx=ky=0).
Eigenvalues and eigenvectors are stored in vals and vecs respectively.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ttg</span> <span class="o">=</span> <span class="n">TTGModel</span><span class="p">(</span><span class="mf">1.56</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ham</span> <span class="o">=</span>  <span class="n">ttg</span><span class="o">.</span><span class="n">gen_ham</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">ham</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytwist.TTGModel.solve_PDOS">
<span class="sig-name descname"><span class="pre">solve_PDOS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-0.1,</span> <span class="pre">-0.099,</span> <span class="pre">-0.098,</span> <span class="pre">-0.097,</span> <span class="pre">-0.096,</span> <span class="pre">-0.095,</span> <span class="pre">-0.094,</span> <span class="pre">-0.093,</span> <span class="pre">-0.092,</span> <span class="pre">-0.091,</span> <span class="pre">-0.09,</span> <span class="pre">-0.089,</span> <span class="pre">-0.088,</span> <span class="pre">-0.087,</span> <span class="pre">-0.086,</span> <span class="pre">-0.085,</span> <span class="pre">-0.084,</span> <span class="pre">-0.083,</span> <span class="pre">-0.082,</span> <span class="pre">-0.081,</span> <span class="pre">-0.08,</span> <span class="pre">-0.079,</span> <span class="pre">-0.078,</span> <span class="pre">-0.077,</span> <span class="pre">-0.076,</span> <span class="pre">-0.075,</span> <span class="pre">-0.074,</span> <span class="pre">-0.073,</span> <span class="pre">-0.072,</span> <span class="pre">-0.071,</span> <span class="pre">-0.07,</span> <span class="pre">-0.069,</span> <span class="pre">-0.068,</span> <span class="pre">-0.067,</span> <span class="pre">-0.066,</span> <span class="pre">-0.065,</span> <span class="pre">-0.064,</span> <span class="pre">-0.063,</span> <span class="pre">-0.062,</span> <span class="pre">-0.061,</span> <span class="pre">-0.06,</span> <span class="pre">-0.059,</span> <span class="pre">-0.058,</span> <span class="pre">-0.057,</span> <span class="pre">-0.056,</span> <span class="pre">-0.055,</span> <span class="pre">-0.054,</span> <span class="pre">-0.053,</span> <span class="pre">-0.052,</span> <span class="pre">-0.051,</span> <span class="pre">-0.05,</span> <span class="pre">-0.049,</span> <span class="pre">-0.048,</span> <span class="pre">-0.047,</span> <span class="pre">-0.046,</span> <span class="pre">-0.045,</span> <span class="pre">-0.044,</span> <span class="pre">-0.043,</span> <span class="pre">-0.042,</span> <span class="pre">-0.041,</span> <span class="pre">-0.04,</span> <span class="pre">-0.039,</span> <span class="pre">-0.038,</span> <span class="pre">-0.037,</span> <span class="pre">-0.036,</span> <span class="pre">-0.035,</span> <span class="pre">-0.034,</span> <span class="pre">-0.033,</span> <span class="pre">-0.032,</span> <span class="pre">-0.031,</span> <span class="pre">-0.03,</span> <span class="pre">-0.029,</span> <span class="pre">-0.028,</span> <span class="pre">-0.027,</span> <span class="pre">-0.026,</span> <span class="pre">-0.025,</span> <span class="pre">-0.024,</span> <span class="pre">-0.023,</span> <span class="pre">-0.022,</span> <span class="pre">-0.021,</span> <span class="pre">-0.02,</span> <span class="pre">-0.019,</span> <span class="pre">-0.018,</span> <span class="pre">-0.017,</span> <span class="pre">-0.016,</span> <span class="pre">-0.015,</span> <span class="pre">-0.014,</span> <span class="pre">-0.013,</span> <span class="pre">-0.012,</span> <span class="pre">-0.011,</span> <span class="pre">-0.01,</span> <span class="pre">-0.009,</span> <span class="pre">-0.008,</span> <span class="pre">-0.007,</span> <span class="pre">-0.006,</span> <span class="pre">-0.005,</span> <span class="pre">-0.004,</span> <span class="pre">-0.003,</span> <span class="pre">-0.002,</span> <span class="pre">-0.001,</span> <span class="pre">0.,</span> <span class="pre">0.001,</span> <span class="pre">0.002,</span> <span class="pre">0.003,</span> <span class="pre">0.004,</span> <span class="pre">0.005,</span> <span class="pre">0.006,</span> <span class="pre">0.007,</span> <span class="pre">0.008,</span> <span class="pre">0.009,</span> <span class="pre">0.01,</span> <span class="pre">0.011,</span> <span class="pre">0.012,</span> <span class="pre">0.013,</span> <span class="pre">0.014,</span> <span class="pre">0.015,</span> <span class="pre">0.016,</span> <span class="pre">0.017,</span> <span class="pre">0.018,</span> <span class="pre">0.019,</span> <span class="pre">0.02,</span> <span class="pre">0.021,</span> <span class="pre">0.022,</span> <span class="pre">0.023,</span> <span class="pre">0.024,</span> <span class="pre">0.025,</span> <span class="pre">0.026,</span> <span class="pre">0.027,</span> <span class="pre">0.028,</span> <span class="pre">0.029,</span> <span class="pre">0.03,</span> <span class="pre">0.031,</span> <span class="pre">0.032,</span> <span class="pre">0.033,</span> <span class="pre">0.034,</span> <span class="pre">0.035,</span> <span class="pre">0.036,</span> <span class="pre">0.037,</span> <span class="pre">0.038,</span> <span class="pre">0.039,</span> <span class="pre">0.04,</span> <span class="pre">0.041,</span> <span class="pre">0.042,</span> <span class="pre">0.043,</span> <span class="pre">0.044,</span> <span class="pre">0.045,</span> <span class="pre">0.046,</span> <span class="pre">0.047,</span> <span class="pre">0.048,</span> <span class="pre">0.049,</span> <span class="pre">0.05,</span> <span class="pre">0.051,</span> <span class="pre">0.052,</span> <span class="pre">0.053,</span> <span class="pre">0.054,</span> <span class="pre">0.055,</span> <span class="pre">0.056,</span> <span class="pre">0.057,</span> <span class="pre">0.058,</span> <span class="pre">0.059,</span> <span class="pre">0.06,</span> <span class="pre">0.061,</span> <span class="pre">0.062,</span> <span class="pre">0.063,</span> <span class="pre">0.064,</span> <span class="pre">0.065,</span> <span class="pre">0.066,</span> <span class="pre">0.067,</span> <span class="pre">0.068,</span> <span class="pre">0.069,</span> <span class="pre">0.07,</span> <span class="pre">0.071,</span> <span class="pre">0.072,</span> <span class="pre">0.073,</span> <span class="pre">0.074,</span> <span class="pre">0.075,</span> <span class="pre">0.076,</span> <span class="pre">0.077,</span> <span class="pre">0.078,</span> <span class="pre">0.079,</span> <span class="pre">0.08,</span> <span class="pre">0.081,</span> <span class="pre">0.082,</span> <span class="pre">0.083,</span> <span class="pre">0.084,</span> <span class="pre">0.085,</span> <span class="pre">0.086,</span> <span class="pre">0.087,</span> <span class="pre">0.088,</span> <span class="pre">0.089,</span> <span class="pre">0.09,</span> <span class="pre">0.091,</span> <span class="pre">0.092,</span> <span class="pre">0.093,</span> <span class="pre">0.094,</span> <span class="pre">0.095,</span> <span class="pre">0.096,</span> <span class="pre">0.097,</span> <span class="pre">0.098,</span> <span class="pre">0.099,</span> <span class="pre">0.1])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_it</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytwist.TTGModel.solve_PDOS" title="Permalink to this definition"></a></dt>
<dd><p>Solves the Hamiltonian for a grid of k points within the first Brillouin zone and computes
the density of states (i.e. momentum integrated number of solutions per unit energy)
projected onto each of the four layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nk</strong> (<em>int</em>) – The total number of points in the moire Brillouin zone is nk**2.  Larger nk corresponds to more
accurate and more computationally expensive calculations.</p></li>
<li><p><strong>energies</strong> (<em>numpy array of floats</em>) – A list of energies in electron-Volts at which to compute the density of states.</p></li>
<li><p><strong>xi</strong> (<em>+/-1</em>) – Valley index.</p></li>
<li><p><strong>plot_it</strong> (<em>boolean</em>) – If true a function call will display a plot of the density of states projected onto each layer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>PDOS</strong> – The list contains a numpy array containing the energy dependent density of states
for each of the three layers (elements 0-2) and the total density of states
across all layers (element 3).  PDOS[l][i] is the density of states
on layer l at energy energies[i].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of three numpy arrays, each of shape (len(energies),)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Generate and plot the density of states on the top layer for energies at 2 meV increments from
-100 to +100 meV.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ttg</span> <span class="o">=</span> <span class="n">TTGModel</span><span class="p">(</span><span class="mf">1.56</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.102</span><span class="p">,</span><span class="mf">0.002</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PDOS</span> <span class="o">=</span> <span class="n">ttg</span><span class="o">.</span><span class="n">solve_PDOS</span><span class="p">(</span><span class="n">energies</span> <span class="o">=</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">PDOS</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Plot the density of states on the second layer from the top.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">PDOS</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>Plot the full density of states.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">PDOS</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytwist.TTGModel.solve_along_path">
<span class="sig-name descname"><span class="pre">solve_along_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_it</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_eigenvectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytwist.TTGModel.solve_along_path" title="Permalink to this definition"></a></dt>
<dd><p>Compute the band structure along a path within the moire Brillouin zone.
The path is predefined to be K’ -&gt; K -&gt; Gamma -&gt; M -&gt; K’.  Note that this is
different from the TDBG class so as to clearly display the Dirac crossing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res</strong> (<em>float</em>) – The resolution of the cut, defined as the number of points to sample along the line Gamma -&gt; K</p></li>
<li><p><strong>plot_it</strong> (<em>boolean</em>) – If true a function call will display a plot of the resulting band structure.</p></li>
<li><p><strong>return_eigenvectors</strong> (<em>boolean</em>) – If true return eigenvectors along the k path.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>evals_m</strong> (<em>numpy array, shape (len(kpath), 2*Nq)</em>) – Eigenvalues along the k path for valley xi = -1. Axis 0 indexes points along the k path.
Axis 1 indexes bands.</p></li>
<li><p><strong>evals_p</strong> (<em>numpy array, shape (len(kpath), 2*Nq)</em>) – Eigenvalues along the k path for valley xi = +1. Axis 0 indexes points along the k path.
Axis 1 indexes bands.</p></li>
<li><p><strong>evecs_m</strong> (<em>numpy array, shape (len(kpath), 2*Nq, 2*Nq)</em>) – Eigenvectors along the k path for valley xi = -1.  Axis 0 indexes points along the k path.
Axis 1 indexes into the eigenvector.  Axis 2 indexes bands.  E.g. evecs_m[i,:,j] is the
eigenvector for k point i and band j.</p></li>
<li><p><strong>evecs_p</strong> (<em>numpy array, shape (len(kpath), 2*Nq, 2*Nq)</em>) – Eigenvectors along the k path for valley xi = +1.  Axis 0 indexes points along the k path.
Axis 1 indexes into the eigenvector.  Axis 2 indexes bands.  E.g. evecs_p[i,:,j] is the
eigenvector for k point i and band j.</p></li>
<li><p><strong>kpath</strong> (<em>list of shape (2,) numpy arrays</em>) – List of k points along the path.  Each point is represented as a two component array in the list.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Solve for the bands along the path K’ -&gt; K -&gt; Gamma -&gt; M -&gt; K’, returning eigenvectors.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ttg</span> <span class="o">=</span> <span class="n">TTGModel</span><span class="p">(</span><span class="mf">1.56</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evals_m</span><span class="p">,</span> <span class="n">evals_p</span><span class="p">,</span> <span class="n">evecs_m</span><span class="p">,</span> <span class="n">evecs_p</span><span class="p">,</span> <span class="n">kpath</span> <span class="o">=</span> <span class="n">ttg</span><span class="o">.</span><span class="n">solve_along_path</span><span class="p">(</span><span class="n">return_eigenvectors</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The same thing without returning eigenvectors.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">evals_m</span><span class="p">,</span> <span class="n">evals_p</span><span class="p">,</span> <span class="n">kpath</span> <span class="o">=</span> <span class="n">ttg</span><span class="o">.</span><span class="n">solve_along_path</span><span class="p">()</span>
</pre></div>
</div>
<p>A higher resolution computation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">evals_m</span><span class="p">,</span> <span class="n">evals_p</span><span class="p">,</span> <span class="n">kpath</span> <span class="o">=</span> <span class="n">ttg</span><span class="o">.</span><span class="n">solve_along_path</span><span class="p">(</span><span class="n">res</span> <span class="o">=</span> <span class="mi">64</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Simon Turkel.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>